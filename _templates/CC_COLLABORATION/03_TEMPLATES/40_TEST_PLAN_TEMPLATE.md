# TEST_PLAN_TEMPLATE.md
# 测试计划文档模板

---

> **使用说明**
> 1. 复制此模板到功能目录，重命名为 `40_TEST_PLAN.md`
> 2. 基于 UI_FLOW_SPEC 和 API_SPEC 编写测试用例
> 3. 开发完成后执行测试
> 4. 删除本使用说明块

---

# 40_TEST_PLAN.md
# {功能名称} - 测试计划

> 版本：v1.0
> 最后更新：{YYYY-MM-DD}
> 状态：{Draft | Ready | Executing | Completed}
> 测试负责人：{@username}
> 关联文档：`11_UI_FLOW_SPEC.md`, `11_API_SPEC.md`

---

## 1. 测试概述

### 1.1 测试目标

{本次测试要验证的内容}

### 1.2 测试范围

**包含：**
- {测试范围1}
- {测试范围2}

**不包含：**
- {排除范围}

### 1.3 测试环境

| 环境 | 地址 | 说明 |
|------|------|------|
| 前端 | http://localhost:5173 | Vite 开发服务器 |
| 后端 | http://localhost:3000 | Express 服务器 |
| 数据库 | PostgreSQL | 本地/Supabase |
| 浏览器 | Chrome 120+ | 主要测试浏览器 |

### 1.4 测试工具

| 工具 | 用途 |
|------|------|
| Chrome MCP | UI 自动化测试 |
| Postman / cURL | API 测试 |
| Vitest | 单元测试 |
| Playwright | E2E 测试（可选）|

---

## 2. 功能测试用例

### 2.1 列表页测试

#### TC-LIST-001: 列表数据加载

| 属性 | 值 |
|------|-----|
| 优先级 | P0 |
| 前置条件 | 用户已登录，数据库有数据 |
| 测试步骤 | 1. 访问列表页<br>2. 等待页面加载完成 |
| 预期结果 | 1. 显示 loading 状态<br>2. 数据正确展示在表格中<br>3. 分页信息正确 |
| 验证方式 | Chrome MCP 截图 + 数据对比 |

#### TC-LIST-002: 列表搜索

| 属性 | 值 |
|------|-----|
| 优先级 | P0 |
| 前置条件 | 列表页已加载 |
| 测试步骤 | 1. 在搜索框输入关键词<br>2. 点击搜索按钮 |
| 预期结果 | 1. 列表刷新<br>2. 仅显示匹配的记录<br>3. 分页信息更新 |
| 验证方式 | Chrome MCP |

#### TC-LIST-003: 列表分页

| 属性 | 值 |
|------|-----|
| 优先级 | P0 |
| 前置条件 | 数据总数 > 一页 |
| 测试步骤 | 1. 点击下一页<br>2. 切换每页条数 |
| 预期结果 | 1. 数据正确切换<br>2. 页码更新<br>3. URL 参数更新（如有）|
| 验证方式 | Chrome MCP |

#### TC-LIST-004: 空数据状态

| 属性 | 值 |
|------|-----|
| 优先级 | P1 |
| 前置条件 | 无数据或搜索无结果 |
| 测试步骤 | 1. 清空数据库或搜索不存在的关键词 |
| 预期结果 | 显示空状态组件（el-empty）|
| 验证方式 | Chrome MCP |

### 2.2 新增功能测试

#### TC-CREATE-001: 打开新增弹窗

| 属性 | 值 |
|------|-----|
| 优先级 | P0 |
| 前置条件 | 列表页已加载 |
| 测试步骤 | 点击「新增」按钮 |
| 预期结果 | 1. 弹窗显示<br>2. 表单为空<br>3. 标题为「新增{资源}」|
| 验证方式 | Chrome MCP |

#### TC-CREATE-002: 表单验证

| 属性 | 值 |
|------|-----|
| 优先级 | P0 |
| 前置条件 | 新增弹窗已打开 |
| 测试步骤 | 1. 不填写必填字段<br>2. 点击「确定」|
| 预期结果 | 1. 显示验证错误<br>2. 弹窗不关闭<br>3. 错误字段高亮 |
| 验证方式 | Chrome MCP |

#### TC-CREATE-003: 新增成功

| 属性 | 值 |
|------|-----|
| 优先级 | P0 |
| 前置条件 | 新增弹窗已打开 |
| 测试步骤 | 1. 填写完整表单<br>2. 点击「确定」|
| 预期结果 | 1. 弹窗关闭<br>2. 显示成功提示<br>3. 列表刷新<br>4. 新记录出现 |
| 验证方式 | Chrome MCP + API 验证 |

#### TC-CREATE-004: 取消新增

| 属性 | 值 |
|------|-----|
| 优先级 | P1 |
| 前置条件 | 新增弹窗已打开，已填写部分数据 |
| 测试步骤 | 点击「取消」按钮 |
| 预期结果 | 1. 弹窗关闭<br>2. 数据不保存<br>3. 列表不刷新 |
| 验证方式 | Chrome MCP |

### 2.3 编辑功能测试

#### TC-EDIT-001: 打开编辑弹窗

| 属性 | 值 |
|------|-----|
| 优先级 | P0 |
| 前置条件 | 列表有数据 |
| 测试步骤 | 点击某行的「编辑」按钮 |
| 预期结果 | 1. 弹窗显示<br>2. 表单回显该行数据<br>3. 标题为「编辑{资源}」|
| 验证方式 | Chrome MCP + 数据对比 |

#### TC-EDIT-002: 编辑成功

| 属性 | 值 |
|------|-----|
| 优先级 | P0 |
| 前置条件 | 编辑弹窗已打开 |
| 测试步骤 | 1. 修改字段值<br>2. 点击「确定」|
| 预期结果 | 1. 弹窗关闭<br>2. 显示成功提示<br>3. 列表刷新<br>4. 数据已更新 |
| 验证方式 | Chrome MCP + API 验证 |

### 2.4 删除功能测试

#### TC-DELETE-001: 删除确认

| 属性 | 值 |
|------|-----|
| 优先级 | P0 |
| 前置条件 | 列表有数据 |
| 测试步骤 | 点击某行的「删除」按钮 |
| 预期结果 | 显示确认对话框 |
| 验证方式 | Chrome MCP |

#### TC-DELETE-002: 确认删除

| 属性 | 值 |
|------|-----|
| 优先级 | P0 |
| 前置条件 | 删除确认框已显示 |
| 测试步骤 | 点击「确定」|
| 预期结果 | 1. 确认框关闭<br>2. 显示成功提示<br>3. 列表刷新<br>4. 记录已删除 |
| 验证方式 | Chrome MCP + API 验证 |

#### TC-DELETE-003: 取消删除

| 属性 | 值 |
|------|-----|
| 优先级 | P1 |
| 前置条件 | 删除确认框已显示 |
| 测试步骤 | 点击「取消」|
| 预期结果 | 1. 确认框关闭<br>2. 数据不删除 |
| 验证方式 | Chrome MCP |

---

## 3. API 测试用例

### 3.1 列表接口

#### TC-API-LIST-001: 正常查询

```yaml
请求:
  method: GET
  url: /api/v1/{resources}?page=1&pageSize=20

预期响应:
  status: 200
  body:
    code: 0
    message: "success"
    data:
      list: [...]
      pagination:
        page: 1
        pageSize: 20
        total: {number}
```

#### TC-API-LIST-002: 带搜索参数

```yaml
请求:
  method: GET
  url: /api/v1/{resources}?keyword=test&status=active

预期响应:
  status: 200
  data.list: 仅包含匹配记录
```

### 3.2 创建接口

#### TC-API-CREATE-001: 正常创建

```yaml
请求:
  method: POST
  url: /api/v1/{resources}
  body:
    name: "测试名称"
    description: "测试描述"
    type: "default"

预期响应:
  status: 201
  body:
    code: 0
    message: "创建成功"
    data:
      id: {number}
      name: "测试名称"
```

#### TC-API-CREATE-002: 参数验证失败

```yaml
请求:
  method: POST
  url: /api/v1/{resources}
  body:
    name: ""  # 必填字段为空

预期响应:
  status: 400
  body:
    code: 400
    error:
      code: "VAL_001"
      fields:
        name: "名称不能为空"
```

#### TC-API-CREATE-003: 名称重复

```yaml
请求:
  method: POST
  url: /api/v1/{resources}
  body:
    name: "已存在的名称"

预期响应:
  status: 409
  body:
    code: 409
    error:
      code: "RES_002"
      message: "名称已存在"
```

### 3.3 权限测试

#### TC-API-AUTH-001: 无 Token 访问

```yaml
请求:
  method: GET
  url: /api/v1/{resources}
  headers: {}  # 无 Authorization

预期响应:
  status: 401
  body:
    error:
      code: "AUTH_001"
```

#### TC-API-AUTH-002: Token 过期

```yaml
请求:
  method: GET
  url: /api/v1/{resources}
  headers:
    Authorization: "Bearer expired_token"

预期响应:
  status: 401
```

---

## 4. 边界测试

### 4.1 输入边界

| 测试项 | 边界值 | 预期结果 |
|--------|--------|----------|
| 名称最小长度 | 1 字符 | 验证失败（最少 2 字符）|
| 名称最大长度 | 51 字符 | 验证失败（最多 50 字符）|
| 描述最大长度 | 501 字符 | 验证失败（最多 500 字符）|
| 分页 page | 0 | 自动修正为 1 |
| 分页 pageSize | 101 | 自动修正为 100 |

### 4.2 异常场景

| 场景 | 测试步骤 | 预期结果 |
|------|----------|----------|
| 网络断开 | 断开网络后操作 | 显示网络错误提示 |
| 服务器 500 | 模拟服务器错误 | 显示系统错误提示 |
| 资源不存在 | 访问已删除的资源 | 显示 404 页面 |
| 并发编辑 | 两人同时编辑同一条 | 后保存者覆盖（或冲突提示）|

---

## 5. 性能测试

### 5.1 响应时间

| 接口 | 目标 | 实测 | 结果 |
|------|------|------|------|
| 列表查询 | < 200ms | - | - |
| 详情查询 | < 100ms | - | - |
| 创建 | < 500ms | - | - |
| 更新 | < 500ms | - | - |
| 删除 | < 300ms | - | - |

### 5.2 并发测试

| 场景 | 并发数 | 目标 | 实测 |
|------|--------|------|------|
| 列表查询 | 100 | 无错误 | - |
| 创建操作 | 50 | 无错误 | - |

---

## 6. 兼容性测试

### 6.1 浏览器兼容

| 浏览器 | 版本 | 结果 |
|--------|------|------|
| Chrome | 120+ | - |
| Firefox | 120+ | - |
| Safari | 17+ | - |
| Edge | 120+ | - |

### 6.2 分辨率适配

| 分辨率 | 设备类型 | 结果 |
|--------|----------|------|
| 1920x1080 | 桌面 | - |
| 1440x900 | 笔记本 | - |
| 1366x768 | 小屏笔记本 | - |

---

## 7. 测试执行计划

### 7.1 执行顺序

```
1. 环境准备
   - 启动前后端服务
   - 准备测试数据

2. 冒烟测试
   - TC-LIST-001: 列表加载
   - TC-CREATE-003: 新增成功
   - TC-EDIT-002: 编辑成功
   - TC-DELETE-002: 删除成功

3. 功能测试
   - 执行所有 TC-LIST-*
   - 执行所有 TC-CREATE-*
   - 执行所有 TC-EDIT-*
   - 执行所有 TC-DELETE-*

4. API 测试
   - 执行所有 TC-API-*

5. 边界测试
   - 执行边界值测试
   - 执行异常场景测试

6. 生成测试报告
```

### 7.2 测试数据

```yaml
# 测试数据准备
setup:
  - 创建 5 条正常数据
  - 创建 1 条特殊字符数据
  - 创建 1 条边界长度数据

cleanup:
  - 测试结束后清理测试数据
```

---

## 8. Claude Code 执行指南

### 8.1 使用 Chrome MCP 测试

```markdown
1. 确保 Chrome 已打开并连接 MCP
2. 导航到测试页面
3. 使用 take_snapshot 获取页面状态
4. 使用 click/fill 执行操作
5. 使用 take_screenshot 记录结果
6. 验证结果与预期是否一致
```

### 8.2 API 测试执行

```markdown
1. 使用 Bash 工具执行 curl 命令
2. 解析响应 JSON
3. 对比预期结果
4. 记录测试结果
```

### 8.3 结果记录

```yaml
# 更新测试用例结果
TC-LIST-001:
  status: passed  # passed / failed / blocked
  actual_result: "数据正确加载，显示 20 条记录"
  screenshot: "screenshots/tc-list-001.png"
  executed_at: "2024-12-10T15:30:00"
```

---

## CHANGELOG

| 版本 | 日期 | 作者 | 变更内容 |
|------|------|------|----------|
| v1.0 | {日期} | {作者} | 初始版本 |

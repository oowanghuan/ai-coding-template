# /resume - 断点恢复

你是一个 AI 协作开发助手。用户请求恢复之前的工作上下文。

## 参数

- `$ARGUMENTS`：功能模块名称（如 `user-auth`、`payment-system`）

## 执行步骤

### 1. 验证参数

如果 `$ARGUMENTS` 为空，请扫描 `docs/` 目录，列出所有功能模块：
```
检测到以下功能模块：
1. user-auth
2. payment-system
3. ...

请指定要恢复的功能，例如：/resume user-auth
```

### 2. 读取进度日志

读取 `docs/{feature-name}/30_PROGRESS_LOG.yaml` 文件。

如果文件不存在，提示：
```
❌ 未找到 docs/{feature-name}/30_PROGRESS_LOG.yaml
该功能可能未初始化，请先运行 /new-feature {feature-name}
```

### 3. 解析断点信息

从 YAML 文件中提取 `cc_checkpoint` 部分：

```yaml
cc_checkpoint:
  session_id: "cc-2024-12-11-user-auth"
  last_file_edited: "src/auth/login.vue"
  last_action: "完成登录表单 UI"
  next_step: "实现登录 API 调用"
  context_files:
    - "docs/user-auth/10_DESIGN_FINAL.md"
    - "docs/user-auth/30_PROGRESS_LOG.yaml"
```

### 4. 读取上下文文件

依次读取 `context_files` 中列出的文件，获取设计文档和进度状态。

### 5. 输出恢复摘要

输出格式化的恢复信息：

```
📍 断点恢复 - {feature-name}

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📋 基本信息
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
• Session ID: {session_id}
• 当前阶段: Phase {current_phase} - {phase_name}
• 整体进度: {completion_rate}
• 负责人: {owner}

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🕐 上次状态
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
• 最后编辑: {last_file_edited}
• 最后操作: {last_action}

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
⏭️ 下一步
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
{next_step}

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📂 相关文件
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
{列出 context_files}

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📊 当前进度
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ 已完成 ({done_count}):
{列出已完成的任务}

🔄 进行中 ({wip_count}):
{列出进行中的任务}

⏳ 待开始 ({pending_count}):
{列出待开始的任务，最多显示 5 个}

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

是否继续上次的工作？
```

### 6. 预加载上下文

自动读取以下文件到上下文中（如果存在）：
- `docs/{feature-name}/00_CONTEXT.md` - 功能上下文
- `docs/{feature-name}/10_DESIGN_FINAL.md` - 设计文档
- `docs/{feature-name}/30_PROGRESS_LOG.yaml` - 进度日志
- `{last_file_edited}` - 上次编辑的文件

### 7. 更新断点信息

当用户确认继续后，更新 `cc_checkpoint.session_id` 为新的 session ID。

## 输出示例

```
📍 断点恢复 - user-auth

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📋 基本信息
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
• Session ID: cc-2024-12-11-user-auth
• 当前阶段: Phase 5 - Code（开发实现）
• 整体进度: 45%
• 负责人: @developer

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🕐 上次状态
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
• 最后编辑: src/auth/login.vue
• 最后操作: 完成登录表单 UI

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
⏭️ 下一步
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
实现登录 API 调用

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📂 相关文件
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
• docs/user-auth/10_DESIGN_FINAL.md
• docs/user-auth/30_PROGRESS_LOG.yaml
• src/auth/login.vue

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📊 当前进度
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ 已完成 (3):
• [CODE-001] 创建 auth 模块目录结构
• [CODE-002] 实现登录页面路由
• [CODE-003] 完成登录表单 UI

🔄 进行中 (1):
• [CODE-004] 实现登录 API 调用

⏳ 待开始 (2):
• [CODE-005] 实现 Token 存储
• [CODE-006] 添加登录状态管理

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

是否继续上次的工作？
```

## 注意事项

- 如果 `cc_checkpoint` 不存在或为空，仅显示基本进度信息
- 上下文文件不存在时跳过，不报错
- Session ID 格式：`cc-{日期}-{功能名}`
- 恢复时自动更新 `last_updated` 时间戳

# 05_TECH_DECISIONS.md
# {项目名} - 技术决策记录

> 版本：v0.1
> 架构师：{architect_name}
> 最后更新：{date}
> 状态：Active

---

## 关于本文档

本文档采用 **ADR（Architecture Decision Records）** 格式，记录项目中的重要技术决策。

**为什么需要记录技术决策？**
- 新成员可以快速了解「为什么这样做」
- 避免反复讨论已决定的问题
- 为未来的重构提供上下文

**ADR 状态说明**：
- `Proposed`：提议中，待讨论
- `Accepted`：已接受，正在执行
- `Deprecated`：已废弃，被新决策取代
- `Superseded`：已被取代，指向新 ADR

---

## ADR 触发规则

> **重要**：不是所有技术选择都需要 ADR，避免过度工程化。

### 必须创建 ADR 的情况

| 场景 | 示例 |
|------|------|
| 跨模块边界的技术选择 | 统一的错误处理机制、日志规范 |
| 影响 2 个以上 feature 的决策 | 状态管理方案、API 设计风格 |
| 一旦确定、未来修改成本高的决策 | 数据库选型、主键策略、认证方案 |
| 数据模型 / 租户 / 安全策略 | 多租户架构、数据加密方案 |
| 外部依赖的选择 | 第三方服务、云服务商 |
| 团队有分歧的技术选择 | 需要记录决策过程和理由 |

### 不需要 ADR 的情况

| 场景 | 理由 |
|------|------|
| 单一 feature 内的实现细节 | 范围有限，不影响全局 |
| 可快速替换的库（工具类） | 替换成本低 |
| 纯代码风格选择 | 用 lint 规则而非 ADR |
| 框架内置的最佳实践 | 跟随框架即可，无需记录 |
| 临时性技术方案 | 明确是短期方案时无需 ADR |

### ADR 创建流程

```
1. 识别决策点（满足上述触发条件）
2. 创建 ADR，状态设为 Proposed
3. 团队讨论（可同步或异步）
4. 达成共识后，状态改为 Accepted
5. 实施决策
6. 如需变更，创建新 ADR，将旧 ADR 标为 Superseded
```

---

## 决策索引

| ID | 标题 | 状态 | 日期 |
|----|------|------|------|
| ADR-001 | 前端框架选型 | Accepted | {date} |
| ADR-002 | 后端框架选型 | Accepted | {date} |
| ADR-003 | 数据库选型 | Accepted | {date} |
| ADR-004 | 认证方案选型 | Accepted | {date} |
| ADR-005 | API 设计风格 | Accepted | {date} |

---

## ADR-001: 前端框架选型

### 状态
`Accepted` - {date}

### 上下文
项目需要选择前端框架，团队需要在 Vue、React、Angular 等主流框架中做出选择。

**考虑因素**：
- 团队技术栈熟悉度
- 生态系统成熟度
- 长期维护成本
- 招聘难度

### 决策
选择 **{Vue 3 / React 18 / ...}** 作为前端框架。

### 备选方案

| 方案 | 优点 | 缺点 |
|------|------|------|
| Vue 3 | 学习曲线平缓、中文社区活跃 | 大型项目最佳实践较少 |
| React 18 | 生态最丰富、大厂背书 | 学习成本较高、选择过多 |
| Angular | 企业级完整方案 | 学习曲线陡峭、体积大 |

### 理由
{详细说明选择该方案的理由}

### 影响
- 需要团队学习/熟悉 {framework}
- UI 组件库选择范围：{Element Plus / Ant Design / ...}
- 构建工具配套：{Vite / Webpack / ...}

### 相关文档
- 02_ARCHITECTURE.md - 前端架构章节

---

## ADR-002: 后端框架选型

### 状态
`Accepted` - {date}

### 上下文
项目需要选择后端技术栈，考虑团队能力和项目需求。

**考虑因素**：
- 性能要求
- 开发效率
- 团队熟悉度
- 生态系统

### 决策
选择 **{NestJS / FastAPI / Gin / ...}** 作为后端框架。

### 备选方案

| 方案 | 优点 | 缺点 |
|------|------|------|
| NestJS (Node.js) | TypeScript 全栈、架构清晰 | 性能一般 |
| FastAPI (Python) | 开发效率高、自动文档 | 异步生态不如 Node |
| Gin (Go) | 性能优异、部署简单 | 生态相对较小 |

### 理由
{详细说明选择该方案的理由}

### 影响
- ORM 选择：{Prisma / SQLAlchemy / GORM / ...}
- 部署方式：{Docker / 二进制 / ...}

---

## ADR-003: 数据库选型

### 状态
`Accepted` - {date}

### 上下文
项目需要选择主数据库，需要考虑数据特点和查询模式。

**数据特点**：
- 数据量预估：{量级}
- 读写比例：{读:写}
- 事务需求：{高/中/低}
- 查询复杂度：{高/中/低}

### 决策
选择 **{PostgreSQL / MySQL / MongoDB / ...}** 作为主数据库。

### 备选方案

| 方案 | 优点 | 缺点 |
|------|------|------|
| PostgreSQL | 功能丰富、扩展性强、JSON 支持好 | 配置相对复杂 |
| MySQL | 成熟稳定、运维简单 | 功能相对保守 |
| MongoDB | 灵活 Schema、水平扩展 | 事务支持较弱 |

### 理由
{详细说明选择该方案的理由}

### 影响
- 数据库托管：{RDS / 自建 / Supabase / ...}
- 备份策略：{策略}

---

## ADR-004: 认证方案选型

### 状态
`Accepted` - {date}

### 上下文
项目需要用户认证功能，需要选择合适的认证方案。

**需求**：
- 支持的登录方式：{邮箱/手机/社交登录}
- Token 有效期要求：{时长}
- 多端登录策略：{单端/多端/限制数量}

### 决策
选择 **{JWT / Session / OAuth2 / ...}** 作为认证方案。

### 备选方案

| 方案 | 优点 | 缺点 |
|------|------|------|
| JWT | 无状态、易扩展 | Token 无法主动失效 |
| Session | 可控性强、安全 | 需要存储、扩展复杂 |
| OAuth2 + JWT | 标准化、支持第三方 | 实现复杂 |

### 理由
{详细说明选择该方案的理由}

### 影响
- Token 存储位置：{Cookie / LocalStorage / ...}
- 刷新机制：{Refresh Token / 滑动过期 / ...}

---

## ADR-005: API 设计风格

### 状态
`Accepted` - {date}

### 上下文
项目需要定义 API 设计风格，确保一致性。

### 决策
采用 **{RESTful / GraphQL / gRPC}** 风格设计 API。

### 备选方案

| 方案 | 优点 | 缺点 |
|------|------|------|
| RESTful | 简单直观、工具支持好 | 可能 over-fetching |
| GraphQL | 灵活查询、类型安全 | 学习成本、缓存复杂 |
| gRPC | 性能优异、强类型 | 浏览器支持差 |

### 理由
{详细说明选择该方案的理由}

### 约定
- URL 格式：`/api/v1/{resource}`
- HTTP 方法语义：GET 查询、POST 创建、PUT 更新、DELETE 删除
- 响应格式：
  ```json
  {
    "code": 0,
    "message": "success",
    "data": {}
  }
  ```

---

## ADR 模板

复制以下模板创建新的 ADR：

```markdown
## ADR-{NNN}: {标题}

### 状态
`Proposed` - {date}

### 上下文
{描述问题背景和需要决策的原因}

### 决策
{描述做出的决策}

### 备选方案

| 方案 | 优点 | 缺点 |
|------|------|------|
| 方案A | ... | ... |
| 方案B | ... | ... |

### 理由
{详细说明选择该方案的理由}

### 影响
{列出这个决策带来的影响}

### 相关文档
- {相关文档链接}
```

---

## CHANGELOG

| 版本 | 日期 | 作者 | 变更内容 |
|------|------|------|----------|
| v0.1 | {date} | {author} | 初始版本 |
